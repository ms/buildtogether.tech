<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<script defer data-domain="buildtogether.tech" src="https://plausible.io/js/plausible.js"></script>
<link rel="icon" type="image/x-icon" href="../files/favicon.ico">
<link rel="stylesheet" href="../mccole.css">
<link rel="stylesheet" href="../codehilite-tango.css">

    <title>Building Software Together: Organizing Analyais</title>
  </head>
  <body class="page">
    <div class="centered title">
      
      <h2><a href="../">Building Software Together</a></h2>
      <h1>Chapter 4: Organizing Analyais</h1>
      
      <p>
        <img class="page-logo" src="../codebender.svg" alt="logo" />
      </p>
    </div>

<ul>
<li>The steps in most data analysis projects are:<ol>
<li>Find data</li>
<li>Collect it</li>
<li>Tidy it</li>
<li>Do calculations</li>
<li>Report results</li>
</ol>
</li>
<li>How can we make all of this easier to understand, reproduce, and extend?</li>
<li>To illustrate, let's find out how many versions of Python packages there are</li>
</ul>
<h2>Getting Data</h2>
<ul>
<li>Data source is simple [PyPI][pypi] package index page <a href="https://pypi.org/simple/">https://pypi.org/simple/</a><ul>
<li>Has HTML links to one page per package</li>
</ul>
</li>
<li>Each package's page has links to released versions in various formats<ul>
<li>205K entries in total</li>
</ul>
</li>
<li>Some redundancy, e.g., <a class="glossref" href="../glossary/#wheel" markdown="1">wheels</a> and <a class="glossref" href="../glossary/#gzip" markdown="1">gzip'd</a> <a class="glossref" href="../glossary/#tar" markdown="1">tar</a> files<ul>
<li>We have to decide whether to count these separately or fold them together</li>
<li>Every statistical result is the product of many decisions</li>
<li>Different decisions produce different results</li>
</ul>
</li>
</ul>
<h2>Scraping Web Pages</h2>
<ul>
<li>Use the [<code>requests</code>][requests] library to get page</li>
<li>HTML is very highly structured,
    so we can get away with using <a class="glossref" href="../glossary/#regular_expression" markdown="1">regular expressions</a> to extract fields<ul>
<li>[This is a sin][regular-expressions-html]</li>
<li>Look at better ways in an exercise</li>
</ul>
</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">time</span>


<span class="c1"># Match package URL in main index page.</span>
<span class="n">RE_PACKAGE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;a href=&quot;(.+?)&quot;&gt;&#39;</span><span class="p">)</span>

<span class="c1"># Match release URL in package index page.</span>
<span class="n">RE_RELEASE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;a href=&quot;.+?&quot;&gt;(.+?)&lt;/a&gt;&#39;</span><span class="p">)</span>

<span class="c1"># PyPI domain.</span>
<span class="n">DOMAIN</span> <span class="o">=</span> <span class="s1">&#39;https://pypi.org&#39;</span>


<span class="n">index_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DOMAIN</span><span class="si">}</span><span class="s1">/simple/&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Package,Releases&#39;</span><span class="p">)</span>
<span class="n">all_packages</span> <span class="o">=</span> <span class="n">RE_PACKAGE</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">index_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="k">for</span> <span class="n">package</span> <span class="ow">in</span> <span class="n">all_packages</span><span class="p">:</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">package</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DOMAIN</span><span class="si">}{</span><span class="n">package</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">package_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">RE_RELEASE</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">package_response</span><span class="o">.</span><span class="n">text</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div>

<ul>
<li>First run crashed after a few minutes because of a missing sub-page</li>
<li>So add a check on the HTTP status codes from queries<ul>
<li>Record <a class="glossref" href="../glossary/#na" markdown="1"><code>NA</code></a> for those pages</li>
<li>And hope that analysis software interprets this as "not available"
    rather than Namibia or the element sodium</li>
</ul>
</li>
<li>Add some logging so that we can tell how long the program is going to take to run<ul>
<li>About 30K seconds, or 8.5 hours</li>
</ul>
</li>
</ul>
<div class="callout">
<h3>A Small Grumble</h3>
<p>Ideally, the code above would morph into the code shown below
so that you could see what was the same and what was different.
A second-best solution would be an easy way to highlight modified lines,
with an emphasis on "easy".
One day...</p>
</div>
<div class="codehilite"><pre><span></span><code><span class="c1"># !/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">time</span>


<span class="c1"># Match package URL in main index page.</span>
<span class="n">RE_PACKAGE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;a href=&quot;(.+?)&quot;&gt;&#39;</span><span class="p">)</span>

<span class="c1"># Match release URL in package index page.</span>
<span class="n">RE_RELEASE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;a href=&quot;.+?&quot;&gt;(.+?)&lt;/a&gt;&#39;</span><span class="p">)</span>

<span class="c1"># PyPI domain.</span>
<span class="n">DOMAIN</span> <span class="o">=</span> <span class="s1">&#39;https://pypi.org&#39;</span>


<span class="c1"># Get main index page.</span>
<span class="n">index_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DOMAIN</span><span class="si">}</span><span class="s1">/simple/&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">index_response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">,</span> \
    <span class="sa">f</span><span class="s1">&#39;Unexpected status for index page </span><span class="si">{</span><span class="n">index_response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="c1"># Get sub-pages and count releases in each.</span>
<span class="n">num_seen</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">t_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Package,Releases&#39;</span><span class="p">)</span>
<span class="n">all_packages</span> <span class="o">=</span> <span class="n">RE_PACKAGE</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">index_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="k">for</span> <span class="n">package</span> <span class="ow">in</span> <span class="n">all_packages</span><span class="p">:</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">package</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">DOMAIN</span><span class="si">}{</span><span class="n">package</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">package_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">package_response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unexpected status for package page </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">package_response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
              <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="n">count</span> <span class="o">=</span> <span class="s1">&#39;NA&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">RE_RELEASE</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">package_response</span><span class="o">.</span><span class="n">text</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">num_seen</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">num_seen</span> <span class="o">%</span> <span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">t_elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t_start</span>
        <span class="n">t_expected</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_packages</span><span class="p">)</span> <span class="o">*</span> <span class="n">t_elapsed</span> <span class="o">/</span> <span class="n">num_seen</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">num_seen</span><span class="si">}</span><span class="s1"> @ </span><span class="si">{</span><span class="n">t_elapsed</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> / </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">all_packages</span><span class="p">)</span><span class="si">}</span><span class="s1"> @ </span><span class="si">{</span><span class="n">t_expected</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
              <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</code></pre></div>

<ul>
<li>Still not a friendly program<ul>
<li>If several thousand people run this program at the same time it will slow PyPI down</li>
</ul>
</li>
<li>Unlikely in this case,
    but a school could easily wind up being blacklisted
    if a hundred students are grabbing data at the same time</li>
<li>Popular data sources have to manage floods of requests</li>
<li>Programs should <a class="glossref" href="../glossary/#throttle" markdown="1">throttle</a> their own activity</li>
</ul>
<h2>Reporting Results</h2>
<ul>
<li><a class="glossref" href="../glossary/#descriptive_statistics" markdown="1">Descriptive statistics</a> are key facts about data</li>
<li>The <a class="glossref" href="../glossary/#median" markdown="1">median</a> is the middle value<ul>
<li>If \(  N \) is odd, sort and take the middle</li>
<li>If \(  N \) is even, sort and average the two middle values</li>
</ul>
</li>
<li>The <a class="glossref" href="../glossary/#mean" markdown="1">mean</a> is the weighted center of the data<ul>
<li>\(   \mu = \frac{1}{N} \sum x_i  \)</li>
</ul>
</li>
<li>If there are a few outliers, the mean can be very different from the median<ul>
<li>Mean of <code>[1, 2, 3, 4, 100]</code> is 22, but median is 3</li>
<li>Which is why those who have like to quote means rather than medians</li>
</ul>
</li>
<li><a class="glossref" href="../glossary/#variance" markdown="1">Variance</a> measures the spread of values<ul>
<li>\(   \sigma^2 = \frac{1}{N} \sigma (x_i - \mu)^2  \)</li>
<li>Squaring the differences gives extra weight to outliers...</li>
<li>...but makes variance hard to use directly, since its units are (for example) lines squared</li>
</ul>
</li>
<li>Instead, use the <a class="glossref" href="../glossary/#standard_deviation" markdown="1">standard deviation</a><ul>
<li>Square root of the variance, so it has the same units as the data</li>
</ul>
</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">datafile</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">packages</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">datafile</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">packages</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;var&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]))</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>python version-statistics.py release-count.csv
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="w">            </span><span class="n">Releases</span><span class="w"></span>
<span class="n">mean</span><span class="w">       </span><span class="mf">11.236351</span><span class="w"></span>
<span class="n">median</span><span class="w">      </span><span class="mf">4.000000</span><span class="w"></span>
<span class="k">var</span><span class="w">      </span><span class="mf">2501.398099</span><span class="w"></span>
<span class="n">std</span><span class="w">        </span><span class="mf">50.013979</span><span class="w"></span>
<span class="nb">min</span><span class="w">         </span><span class="mf">0.000000</span><span class="w"></span>
<span class="nb">max</span><span class="w">     </span><span class="mf">10797.000000</span><span class="w"></span>
</code></pre></div>

<ul>
<li>Half of all packages have had fewer than four releases</li>
<li>The mean is only slightly higher (1/5 of a standard deviation)</li>
<li>And yeah, a package with almost 11,000 releases will pull things up<ul>
<li><code>ccxt</code> is a cryptocurrency, so they might be using releases as ledger updates</li>
</ul>
</li>
</ul>
<h2>Displaying Results</h2>
<ul>
<li>Again, a histogram shows the distribution of values<ul>
<li>Its shape (and hence our interpretation) depends on how we <a class="glossref" href="../glossary/#bin" markdown="1">bin</a> the data</li>
</ul>
</li>
<li>Given how long data collection takes,
    most sensible thing is to collect the data once and write separate plotting programs to view it<ul>
<li>Provide name of data file on the command line</li>
</ul>
</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>

<span class="n">datafile</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">packages</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">datafile</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distribution of Releases&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">packages</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Releases&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">packages</span><span class="p">[</span><span class="s2">&quot;Releases&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1"> missing values&#39;</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">packages</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Releases&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">log_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s1">&#39;figures/release-count.svg&#39;</span><span class="p">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>python version-histogram.py release-count.csv
</code></pre></div>

<div class="codehilite"><pre><span></span><code>Distribution of Releases
          Package
Releases         
0.0         11721
1.0         33992
2.0         32829
3.0         14999
4.0         18339
5.0          8946
...
4505.0          1
5133.0          1
6460.0          1
10797.0         1

[561 rows x 1 columns]
14 missing values
</code></pre></div>

<figure id="release-count">
  <img src="./figures/release-count.svg" alt="Histogram showing steeply declining curve from X equals 0 to X above 10,000 with peak over 200,000 at X equals 0." />
  <figcaption markdown="1">Figure 4.1: Release Count</figcaption>
</figure>

<ul>
<li>Printed output includes the value for packages with zero releases</li>
<li>But does the histogram?<ul>
<li>What does Plotly do with <code>log(0)</code>?</li>
</ul>
</li>
<li>Let's try:</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="nb">slice</span> <span class="o">=</span> <span class="n">packages</span><span class="p">[</span><span class="n">packages</span><span class="p">[</span><span class="s1">&#39;Releases&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="nb">slice</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Releases&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">log_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s1">&#39;figures/release-count-low.svg&#39;</span><span class="p">)</span>
</code></pre></div>

<figure id="release-count-low">
  <img src="./figures/release-count-low.svg" alt="Histogram showing smoothly declining curve from X equals 0 to X equals 100 with over 10,000 values at X equals zero and alternating high and low bars." />
  <figcaption markdown="1">Figure 4.2: Release Count (Low End)</figcaption>
</figure>

<ul>
<li>It seems to include zero</li>
<li>But that double-stepping looks weird</li>
<li>
<p>Is it a plotting artifact or a result of double-counting packages that are released in multiple formats?</p>
<ul>
<li>For that, we need better data</li>
</ul>
</li>
<li>
<p>Use a <a class="glossref" href="../glossary/#violin_plot" markdown="1">violin plot</a> to get a feel for the shape of the data</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="n">datafile</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">packages</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">datafile</span><span class="p">)</span>
<span class="nb">slice</span> <span class="o">=</span> <span class="n">packages</span><span class="p">[</span><span class="n">packages</span><span class="p">[</span><span class="s1">&#39;Releases&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">violin</span><span class="p">(</span><span class="nb">slice</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Releases&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s1">&#39;figures/release-count-violin.svg&#39;</span><span class="p">)</span>
</code></pre></div>

<figure id="release-count-violin">
  <img src="./figures/release-count-violin.svg" alt="Symmetric vertical violin plot with almost all values in bulge at bottom end." />
  <figcaption markdown="1">Figure 4.3: Violin Plot (Low End)</figcaption>
</figure>

<ul>
<li>Can also use a <a class="glossref" href="../glossary/#box_and_whisker_plot" markdown="1">box-and-whisker plot</a><ul>
<li>Lines show minimum, first <a class="glossref" href="../glossary/#quartile" markdown="1">quartile</a>, median, third quartile, and maximum</li>
<li>Box shows first quartile to third quartile (so half the data lies inside the box)</li>
</ul>
</li>
<li>Distance from first quartile to third quartile is the <a class="glossref" href="../glossary/#iqr" markdown="1">inter-quartile range</a><ul>
<li>Lower and upper lines cut off at 1.5\(  \times \)IQR</li>
<li>Anything beyond that is considered an outlier and shown as a point</li>
</ul>
</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="nb">slice</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Releases&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="s1">&#39;figures/release-count-box.svg&#39;</span><span class="p">)</span>
</code></pre></div>

<figure id="release-count-box">
  <img src="./figures/release-count-box.svg" alt="Symmetric vertical box plot with almost all values at low end." />
  <figcaption markdown="1">Figure 4.4: Box-and-Whisker Plot (Low End)</figcaption>
</figure>

<h2>More Project Structure</h2>
<ul>
<li>Data analysis projects are a special case of software development projects</li>
<li>Starting point is <a class="glossref" href="../glossary/#taschuks_rules" markdown="1">Taschuk's Rules</a>:<ol>
<li>Use version control.</li>
<li>Document your code and usage</li>
<li>Make common operations easy to control.</li>
<li>Version your releases.</li>
<li>Reuse software (within reason)</li>
<li>Rely on build tools and package managers for installation.</li>
<li>Do not require root or other special privileges to install or run.</li>
<li>Eliminate hard-coded paths.</li>
<li>Include a small test set that can be run to ensure the software is actually working.</li>
<li>Produce identical results when given identical inputs.</li>
</ol>
</li>
<li>The first three rules are the most important<ul>
<li>We assume you are already using version control</li>
</ul>
</li>
<li>Restructure our program</li>
<li>The <a class="glossref" href="../glossary/#main_driver" markdown="1">main driver</a> lays out the overall flow of the program<ul>
<li>Parse command-line options</li>
<li>Set up</li>
<li>Produce output incrementally while processing data
    (rather than read-process-write)</li>
</ul>
</li>
<li>Include a <a class="glossref" href="../glossary/#docstring" markdown="1">docstring</a> for help</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Main driver.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parse_args</span><span class="p">()</span>
    <span class="n">all_packages</span> <span class="o">=</span> <span class="n">get_package_list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="n">progress</span> <span class="o">=</span> <span class="n">initialize_progress</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">all_packages</span><span class="p">)</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">lineterminator</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="s1">&#39;Package&#39;</span><span class="p">,</span> <span class="s1">&#39;Release&#39;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">package</span> <span class="ow">in</span> <span class="n">all_packages</span><span class="p">:</span>
        <span class="n">get_package_info</span><span class="p">(</span><span class="n">package</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span>
        <span class="n">report_progress</span><span class="p">(</span><span class="n">progress</span><span class="p">)</span>

<span class="c1"># ...</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>

<ul>
<li>
<p>Uses the [<code>csv</code>][csv-py] package to format output instead of printing strings ourselves</p>
<ul>
<li>Takes care of <a class="glossref" href="../glossary/#escape_character" markdown="1">escaping</a> special characters</li>
</ul>
</li>
<li>
<p>Parse command-line arguments</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_args</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Parse command-line arguments.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--restart&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;restart from this package&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--verbose&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;show progress&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</code></pre></div>

<ul>
<li>
<p>Use [<code>argparse</code>][argparse] to parse command-line arguments</p>
<ul>
<li><code>--verbose</code> to track progress (because it takes hours)</li>
<li><code>--restart</code> to start from a specified point because networks fail<ul>
<li>May result in redundant records</li>
<li>Definitely results in header appearing multiple times</li>
<li>Clean up afterward</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Get the main package list</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="c1"># Match package URL in main index page.</span>
<span class="n">RE_PACKAGE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;a href=&quot;(.+?)&quot;&gt;&#39;</span><span class="p">)</span>

<span class="c1"># ...</span>

<span class="k">def</span> <span class="nf">get_package_list</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Get main package listing page and extract values.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">BASE_URL</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">,</span> \
        <span class="sa">f</span><span class="s1">&#39;Unexpected status for index page </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">all_packages</span> <span class="o">=</span> <span class="n">RE_PACKAGE</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="n">all_packages</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">all_packages</span><span class="p">]</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">restart</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">all_packages</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">restart</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">start</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unable to find </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">restart</span><span class="si">}</span><span class="s1"> in package list&#39;</span><span class="p">,</span>
                  <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">all_packages</span> <span class="o">=</span> <span class="n">all_packages</span><span class="p">[</span><span class="n">start</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">all_packages</span>
</code></pre></div>

<ul>
<li>Regular expression is at the top of the file with other "constants"<ul>
<li>Unfortunately no way to attach a docstring</li>
</ul>
</li>
<li>Get the main package listing page<ul>
<li>Fail if it can't be found rather than supporting restart</li>
<li>Slice here to get the package list</li>
</ul>
</li>
<li>Handle restart here as well (and fail if that isn't going to work)</li>
<li>
<p>Use <code>all_packages</code> rather than just <code>packages</code> as a name
    so that the code reads aloud more clearly</p>
<ul>
<li>Look at consistent variable naming in the exercises</li>
</ul>
</li>
<li>
<p>Get information about a single package</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_package_info</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">writer</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Get and print information about a specific package.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">BASE_URL</span><span class="si">}{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unexpected status for package page </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
              <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;NA&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">all_releases</span> <span class="o">=</span> <span class="n">RE_RELEASE</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">release</span> <span class="ow">in</span> <span class="n">all_releases</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="n">name</span><span class="p">,</span> <span class="n">release</span><span class="p">])</span>
</code></pre></div>

<ul>
<li>
<p>Get packages one at a time</p>
<ul>
<li>Some attempts fail (status code is not 200)</li>
<li>Record these as <code>NA</code> rather than failing because we <em>can</em> proceed</li>
</ul>
</li>
<li>
<p>Report progress</p>
</li>
<li>Anything that takes long enough to worry about should tell users it's OK<ul>
<li>But that should be an option so that it <em>doesn't</em> ask for attention in a production pipeline</li>
</ul>
</li>
<li>Could initialize the record-keeping in <code>main</code>,
    but that function reads more cleanly if this low-level detail is hidden away</li>
<li>Goes to <code>sys.stderr</code> so that regular output can be redirected to file</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">initialize_progress</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">packages</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Initialize record keeping for progress monitoring.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;report&#39;</span><span class="p">:</span> <span class="n">args</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span>
        <span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span>
        <span class="s1">&#39;expected&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">packages</span><span class="p">),</span>
        <span class="s1">&#39;seen&#39;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">}</span>


<span class="k">def</span> <span class="nf">report_progress</span><span class="p">(</span><span class="n">progress</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Report progress, updating the progress record as a side effect.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">progress</span><span class="p">[</span><span class="s1">&#39;report&#39;</span><span class="p">]):</span>
        <span class="k">return</span>
    <span class="n">progress</span><span class="p">[</span><span class="s1">&#39;seen&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">progress</span><span class="p">[</span><span class="s1">&#39;seen&#39;</span><span class="p">]</span> <span class="o">%</span> <span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">progress</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">progress</span><span class="p">[</span><span class="s1">&#39;expected&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">elapsed</span> <span class="o">/</span> <span class="n">progress</span><span class="p">[</span><span class="s1">&#39;seen&#39;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">progress</span><span class="p">[</span><span class="s1">&#39;seen&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> @ </span><span class="si">{</span><span class="n">elapsed</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">progress</span><span class="p">[</span><span class="s1">&#39;expected&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> @ </span><span class="si">{</span><span class="n">duration</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
              <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</code></pre></div>

<ul>
<li>This program does not have an option for output file<ul>
<li>Should probably have one option to create a new file and another to append to an existing file</li>
</ul>
</li>
<li>Should probably also have an option to stop trying if enough pages fail</li>
</ul>
<h2>Noble's Rules</h2>
<p><a class="glossref" href="../glossary/#nobles_rules" markdown="1">Noble's Rules</a> are a way to organize small data analysis projects.
Each one lives in a separate Git repository
whose subdirectories are organized by purpose:</p>
<ul>
<li>
<p><code>src</code> (short for "source") holds source code
    for programs written in languages like C or C++ that need to be compiled.
    Many projects don't have this directory
    because all of their code is written in languages that don't need compilation.</p>
</li>
<li>
<p>Runnable programs go in <code>bin</code> (an old Unix abbreviation for "binary", meaning "not text").
    This includes the compiled and runnable versions of C and C++ programs,
    and also shell scripts,
    Python or R programs,
    and everything else that can be executed.</p>
</li>
<li>
<p>Raw data goes in in <code>data</code> and is never modified after being stored.</p>
</li>
<li>
<p>Results are put in <code>results</code>.
    This includes cleaned-up data
    and everything else that can be rebuilt using what's in <code>bin</code> and <code>data</code>.
    If intermediate results can be re-created quickly and easily,
    they might not be stored in version control,
    but anything that is included in a report should be here.</p>
</li>
<li>
<p>Finally,
    documentation and manuscripts go in <code>doc</code>.</p>
</li>
</ul>
<p>Documentation is often generated from source code,
and it's usually a bad idea to mix handwritten and machine-generated files,
so most projects now use separate subdirectories for software documentation (<code>doc</code>)
and reports (<code>reports</code> or <code>papers</code>).
People also often create a <code>figures</code> directory to hold generated figures
rather than putting them in <code>results</code>.</p>
<p>The directories in the top level of each project are organized by purpose,
but the directories within <code>data</code> and <code>results</code> are organized chronologically
so that it's easy to see when data was gathered and when results were generated.
These directories all have names in <a class="glossref" href="../glossary/#iso_date_format" markdown="1">ISO date format</a> like <code>YYYY-MM-DD</code>
to make it easy to sort them chronologically.
This naming is particularly helpful when data and results are used in several reports.</p>
<p>At all levels,
filenames should be easy to match with simple patterns.
For example,
a project might use <code><em>species</em><em><em>organ</em></em><em>treatment</em>.csv</code>
as a file-naming convention,
giving filenames like <code>human_kidney_cm200.csv</code>.
This allows <code>human_*_cm200.csv</code> to match all human organs
or <code>*_kidney_*.csv</code> to match all kidney data.
It does produce long filenames,
but tab completion means you only have to type them once.
Long filenames are just as easy to match in programs:
Python's [<code>glob</code>][glob] module will take a pattern and return a list of matching filenames.</p>
<h2>Tracking Data</h2>
<ul>
<li>Data should be published along with reports<ul>
<li>How else can people check or extend your work?</li>
</ul>
</li>
<li>Large datasets that are archived and maintained by trusted institutions (e.g., open government data)
    don't need to be stored<ul>
<li>Just include a link, a method for downloading, and a date</li>
</ul>
</li>
<li>If a report involves a new dataset:<ul>
<li>Always use <a class="glossref" href="../glossary/#tidy_data" markdown="1">tidy data</a>.</li>
<li>Include keywords describing the data in the project's <code>README.md</code>
    so that they appear on its home page and can easily be found by search engines.</li>
<li>Give every dataset and every report a unique identifier.</li>
<li>Use well-known formats like CSV and HDF5.</li>
<li>Include an explicit license.</li>
<li>Include units and other metadata.</li>
</ul>
</li>
</ul>
<p>The last point is often the hardest for people to implement,
since many researchers have never seen a well-documented dataset.
The <a class="glossref" href="../glossary/#data_manifest" markdown="1">data manifest</a> for [<a href="../bibliography/#Diehm2018">Diehm2018</a>] is a good example;
each dataset is described by an entry like this:</p>
<div class="callout">
<ul>
<li>What is this?: This file contains all of the measurements for 80 pairs of blue jeans from the most popular and widely available brands in the US.</li>
<li>Source(s): All data was collected from manual measurements by Jan Diehm and Amber Thomas at brick and mortar stores in Nashville, New York, and Seattle.
    All measurements of front pockets were taken of the right-hand-side front pocket of empty jeans.</li>
<li>Last Modified: August 13, 2018</li>
<li>Contact Information: Amber Thomas</li>
<li>Spatial Applicability: United States</li>
<li>Temporal Applicability: All measurements were collected between June 29 and August 6, 2018</li>
<li>Observations (Rows): Each row represents data from a single pair of jeans.</li>
<li>Variables (Columns):</li>
</ul>
<table>
<thead>
<tr>
<th>Header</th>
<th>Datatype</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>brand</code></td>
<td>text</td>
<td>The full brand name.</td>
</tr>
<tr>
<td><code>style</code></td>
<td>text</td>
<td>The cut of each pair of jeans (in our analysis, we combined straight and boot-cut styles and skinny and slim styles, but these remain separated here).</td>
</tr>
<tr>
<td><code>menWomen</code></td>
<td>text</td>
<td>Whether the jeans were listed as "men's" or "women's".</td>
</tr>
<tr>
<td><code>name</code></td>
<td>text</td>
<td>The name of the specific style of measured pair of jeans as indicated by the tag. (e.g., <code>Fave Super Skinny Jean</code>).</td>
</tr>
<tr>
<td><code>brandSize</code></td>
<td>text</td>
<td>The size of jeans we measured. Each size reflects the sizing for each brand closest to a 32-inch waistband as indicated by the brand's website.</td>
</tr>
<tr>
<td><code>waistSize</code></td>
<td>number</td>
<td>The waistband size (in inches) of each measured pair as reported on the brand's website.</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
</div>
<div class="callout">
<h3>FAIR play</h3>
<p>The [FAIR Principles][fair-principles] [<a href="../bibliography/#Brock2019">Brock2019</a>]
state that data should be <em>findable</em>, <em>accessible</em>, <em>interoperable</em>, and <em>reusable</em>.
They are still aspirational for most researchers,
but they tell us what to aim for.</p>
</div>
<h2>Exercises</h2>
<h3>Why <code>NA</code>?</h3>
<p>Why do statistical packages prefer <code>NA</code> to (for example) an empty cell in a table?</p>
<h3>Getting All Releases</h3>
<p>Rewrite the data collection script to capture all release filenames
so we can filter duplicates,
look at numbering, etc.
(When you're getting data,
get <em>all</em> the data.)</p>
<h3>Controlling Logging</h3>
<p>Rewrite the script to make progress logging controllable with command-line option.</p>
<h3>Beautiful Soup</h3>
<p>Rewrite the script to parse the HTML using [Beautiful Soup][beautiful-soup].
(You may find the documentation on searching the document tree helpful.)</p>
<h3>Logarithmic Zeroes</h3>
<p>How should packages with zero releases be displayed when we are scaling logarithmically?
(Those entries are currently discarded because \(  log(0) \) is undefined.)</p>
<h3>Fifty Per Cent</h3>
<p>Suppose that 50% of the links in the index page failed to resolve.
How would this change our script?
How would it change what statistics we calculate or how we report them?</p>

  <hr/>
<div class="centered">
  <table class="plain footer">
    <tr>
      
      <td><a href="../license/">License</a></td>
      
      <td><a href="../conduct/">Code of Conduct</a></td>
      
      <td><a href="../bibliography/">Bibliography</a></td>
      
      <td><a href="../glossary/">Glossary</a></td>
      
      <td><a href="../links/">Links</a></td>
      
      <td><a href="https://github.com/gvwilson/buildtogether.tech.git">GitHub</a></td>
      
    </tr>
  </table>
</div>

  </body>
</html>
