<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<script defer data-domain="buildtogether.tech" src="https://plausible.io/js/plausible.js"></script>
<link rel="icon" type="image/x-icon" href="../files/favicon.ico">
<link rel="stylesheet" href="../mccole.css">
<link rel="stylesheet" href="../codehilite-tango.css">

    <title>Building Software Together: A Minimum Viable Project</title>
  </head>
  <body class="page">
    <div class="centered title">
      
      <h2><a href="../">Building Software Together</a></h2>
      <h1>Chapter 3: A Minimum Viable Project</h1>
      
      <p>
        <img class="page-logo" src="../codebender.svg" alt="logo" />
      </p>
    </div>

<ul>
<li>Some things are the same for every project</li>
<li>Show the Python version with some notes about JavaScript</li>
</ul>
<h2>Create repository on GitHub</h2>
<ul>
<li>Do this under a personal account, but for a real project would do it under an organizational account</li>
<li>Chose a name that wasn't already taken on [PyPI][pypi]<ul>
<li>Because we want to create a package in future</li>
<li>All the good names are taken, so I chose the name of a small town near where I grew up</li>
</ul>
</li>
<li>Made it public</li>
<li>Added the following:<ul>
<li><code>README.md</code> (this file) is normally a description of the project, but we'll use it for note-taking</li>
<li><code>.gitignore</code> (selected from pulldown) to tell Git not to track ephemeral files generated by Python projects</li>
<li>[MIT license][mit-license] (which GitHub puts in <code>LICENSE</code> rather than <code>LICENSE.md</code> - rename it)</li>
</ul>
</li>
</ul>
<h2>Add the files every project should have</h2>
<ul>
<li>Write these notes</li>
<li>Rename <code>LICENSE</code> to <code>LICENSE.md</code> (because file extensions are good)</li>
<li>Add <code>*~</code> to the <code>.gitignore</code> (for Emacs users)</li>
<li>Commit changes with a message that follows [conventional commits][conventional-commits]:</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="n">feat</span><span class="o">:</span><span class="w"> </span><span class="n">describing</span><span class="w"> </span><span class="n">steps</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">far</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">cleaning</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">files</span><span class="w"></span>

<span class="o">-</span><span class="w">   </span><span class="k">Rename</span><span class="w"> </span><span class="n n-Quoted">`LICENSE`</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="n">it</span><span class="s1">&#39;s a Markdown file</span>
<span class="s1">-   Add notes to `README.md` about steps so far</span>
<span class="s1">-   Add Emacs backup files to `.gitignore</span>
</code></pre></div>

<ul>
<li>The subject line describes what kind of change it is (adding a feature)<ul>
<li>The body itemizes the changes</li>
</ul>
</li>
<li>Push to GitHub</li>
</ul>
<h2>Add Code of Conduct and contributors' guide</h2>
<ul>
<li>Used to add CoC by copying in a Markdown file, but [GitHub now supports this directly][gh-coc]<ul>
<li>Note: use <code>[text][key]</code> links in the body of my Markdown files and <code>[key]: url</code> in the foot</li>
</ul>
</li>
<li>Follow GitHub's instructions to add CoC<ul>
<li>Call the branch <code>feat/code-of-conduct</code> (colons don't play nicely in Git branch names)</li>
</ul>
</li>
<li>Copy in <code>CONTRIBUTING.md</code> from an existing project and edit<ul>
<li>Rename/add tags in GitHub to match descriptions in <code>CONTRIBUTING.md</code> (because GitHub's defaults aren't sensible)</li>
</ul>
</li>
<li><em>Don't</em> add a <code>GOVERNANCE.md</code> file explaining how decisions are made and who gets to make them<ul>
<li>But will as soon as the project attracts other people</li>
</ul>
</li>
<li>Note: if you and your team are creating a lot of projects, consider using [Cookiecutter][cookiecutter] to keep them consistent</li>
</ul>
<h2>Set up Python package</h2>
<ul>
<li>Create <code>mesachie</code> directory to contain package code<ul>
<li>Standard Python package structure to keep package code separate from support code</li>
</ul>
</li>
<li>Add <code>mesachie/__init__.py</code>:</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="sd">&quot;&quot;&quot;Mesachie: a data analysis software project in Python.&quot;&quot;&quot;</span>

<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;0.1.0&quot;</span>
<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Greg Wilson&quot;</span>
</code></pre></div>

<ul>
<li>The existence of <code>__init__.py</code> signals that this directory is an importable module
        -   It can even be empty<ul>
<li>First line is a documentation string (docstring) explaining the file's purpose</li>
<li>The <code>__version__</code> and <code>__author__</code> variables are recognized by Python's packaging tools</li>
</ul>
</li>
<li>Create <code>tests</code> directory <em>beside</em> the <code>mesachie</code> package directory to contain tests<ul>
<li>And create <code>tests/__init__.py</code> to keep testing tools happy</li>
</ul>
</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="sd">&quot;&quot;&quot;Make tests look like a module so actual module will load.&quot;&quot;&quot;</span>
</code></pre></div>

<ul>
<li>Create a [conda][conda] virtual environment to avoid conflicts between packages installed for different projects<ul>
<li>Note: some people prefer <a href="https://www.docker.com/">Docker</a> for isolating environments...</li>
<li>...and because it's what we'll eventually use when we run in the cloud</li>
</ul>
</li>
</ul>
<div class="codehilite"><pre><span></span><code>$ conda create -n mesachie <span class="nv">python</span><span class="o">=</span><span class="m">3</span>.9
<span class="c1"># say &#39;y&#39; to the prompt</span>
$ conda activate mesachie
</code></pre></div>

<ul>
<li>Install <a href="http://pytest.org/">pytest</a> to run tests:<ul>
<li>Can (should) use <code>conda install</code> instead, but <code>pip</code> is simpler for small projects</li>
</ul>
</li>
</ul>
<div class="codehilite"><pre><span></span><code>$ pip install pytest
</code></pre></div>

<ul>
<li>Create <code>requirements.txt</code> to make package installation reproducible<ul>
<li>What version did we get?</li>
</ul>
</li>
</ul>
<div class="codehilite"><pre><span></span><code>$ conda list pytest
<span class="c1"># &gt; pytest        7.1.1</span>
</code></pre></div>

<ul>
<li>Name uses three-part [semantic versioning][semver] to identify major version, minor version, and patch</li>
<li>Create <code>requirements.txt</code> file with major and minor version</li>
</ul>
<div class="codehilite"><pre><span></span><code>pytest&gt;=7.1
</code></pre></div>

<ul>
<li>Create a "heartbeat" test in <code>tests/test_heartbeat.py</code> to make sure we can load our module</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="sd">&quot;&quot;&quot;Check that the project has a heartbeat.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">mesachie</span>


<span class="k">def</span> <span class="nf">test_module_can_be_imported</span><span class="p">():</span>
    <span class="k">pass</span>
</code></pre></div>

<ul>
<li>Names of test files and functions must started with <code>test_</code> so that <code>pytest</code> can find them<ul>
<li>Don't use docstrings for tests: give them long informative names</li>
<li>This test doesn't check anything (<code>pass</code>), but <code>pytest</code> will complain if <code>mesachie</code> cannot be imported</li>
</ul>
</li>
<li>Run the test:</li>
</ul>
<div class="codehilite"><pre><span></span><code>$ pytest
<span class="c1"># &gt; collected 1 item</span>
<span class="c1"># &gt; tests/test_heartbeat.py .</span>
</code></pre></div>

<ul>
<li>Add to these notes, commit, and push</li>
</ul>
<h2>Automation</h2>
<ul>
<li>Want to make common commands re-runnable<ul>
<li>More trustworthy than documentation</li>
</ul>
</li>
<li>Used to use <a href="https://www.gnu.org/software/make/">Make</a> to do this, but it's showing its age<ul>
<li>And its syntax is unpleasant</li>
</ul>
</li>
<li>Use [Invoke][invoke] instead</li>
<li><code>pip install invoke</code> and then add <code>invoke&gt;=1.7</code> to `requirements.txt</li>
<li>Create a file in the project's root directory called <code>tasks.py</code>:</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="sd">&quot;&quot;&quot;Run common tasks.&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">invoke</span> <span class="kn">import</span> <span class="n">task</span>


<span class="nd">@task</span>
<span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;List available tasks.&quot;&quot;&quot;</span>
    <span class="n">c</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;inv --list&quot;</span><span class="p">)</span>


<span class="nd">@task</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Run tests.&quot;&quot;&quot;</span>
    <span class="n">c</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;pytest&quot;</span><span class="p">)</span>
</code></pre></div>

<ul>
<li>The <code>@task</code> decorator identifies functions that can be run as tasks<ul>
<li>They can do any other processing (but we don't need them to yet)</li>
</ul>
</li>
<li>The <code>c</code> parameter is a context that has details about the run<ul>
<li>We don't need that yet either</li>
</ul>
</li>
<li>Run <code>inv list</code>:</li>
</ul>
<div class="codehilite"><pre><span></span><code>Available tasks:

  list   List available tasks
  test   Run tests
</code></pre></div>

<ul>
<li>We need to set up a <a class="glossref" href="../glossary/#linter" markdown="1">linter</a> to check code quality</li>
<li>And <a class="glossref" href="../glossary/#ci" markdown="1">continuous integration</a> to make sure it runs</li>
<li>But we need some useful code first</li>
</ul>

  <hr/>
<div class="centered">
  <table class="plain footer">
    <tr>
      
      <td><a href="../license/">License</a></td>
      
      <td><a href="../conduct/">Code of Conduct</a></td>
      
      <td><a href="../bibliography/">Bibliography</a></td>
      
      <td><a href="../glossary/">Glossary</a></td>
      
      <td><a href="../links/">Links</a></td>
      
      <td><a href="https://github.com/gvwilson/buildtogether.tech.git">GitHub</a></td>
      
    </tr>
  </table>
</div>

  </body>
</html>
